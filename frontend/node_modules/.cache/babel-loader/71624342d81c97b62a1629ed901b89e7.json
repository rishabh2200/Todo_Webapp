{"ast":null,"code":"/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar isUnloading = false;\nvar listenersAdded = false;\n\nvar onPageHide = function onPageHide(event) {\n  isUnloading = !event.persisted;\n};\n\nvar addListeners = function addListeners() {\n  addEventListener('pagehide', onPageHide); // `beforeunload` is needed to fix this bug:\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=987409\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n\n  addEventListener('beforeunload', function () {});\n};\n\nexport var onHidden = function onHidden(cb, once) {\n  if (once === void 0) {\n    once = false;\n  }\n\n  if (!listenersAdded) {\n    addListeners();\n    listenersAdded = true;\n  }\n\n  addEventListener('visibilitychange', function (_a) {\n    var timeStamp = _a.timeStamp;\n\n    if (document.visibilityState === 'hidden') {\n      cb({\n        timeStamp: timeStamp,\n        isUnloading: isUnloading\n      });\n    }\n  }, {\n    capture: true,\n    once: once\n  });\n};","map":null,"metadata":{},"sourceType":"module"}